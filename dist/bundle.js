!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);let i=document.querySelector(".list-films");const n=document.querySelector(".display-1 > p"),o=document.querySelector(".display-2-body > img"),s=document.querySelector(".display-2-body p"),a=document.querySelector(".display-2-body h3"),l=document.querySelector(".display-2-body .genre"),c=document.querySelector(".rating"),d=document.querySelector(".display-2-header"),m=document.querySelector(".exit"),u=e=>{i.innerHTML="",e.map(e=>{i.appendChild(new h(e).render())})},f=e=>{const{Poster:t,Title:r,Year:i,Plot:n,Genre:m,imdbRating:u}=e,f=JSON.parse(localStorage.getItem("films")||"[]"),p=document.querySelector(".display-2-header button.fav");p&&d.removeChild(p);const v=document.createElement("button");v.classList.add("fav"),v.innerHTML="♥",v.addEventListener("click",t=>y(e)),f.map(t=>{t.imdbID==e.imdbID&&v.classList.add("fav-click")}),d.appendChild(v),o.src="N/A"!==t?t:"./img/notfound.png",s.innerHTML=`<span class="bold">Description:</span> ${n}`,a.innerHTML=`${r}(${i})`,l.innerHTML=`<span class="bold">Genre:</span> ${m}`,c.innerHTML=`<span class="bold">IMDb rating:</span> ${u}`};function p(e,t){const r=JSON.parse(localStorage.getItem("films")||"[]");r.map(e=>{e.imdbID==t&&r.splice(r.indexOf(e),1)}),localStorage.setItem("films",JSON.stringify(r)),(new h).renderFilmsToFavorites()}m.addEventListener("click",()=>{document.querySelector(".display-1").style.display="block",document.querySelector(".display-2").style.display="none"});const y=e=>{const t=JSON.parse(localStorage.getItem("films")||"[]"),r=document.querySelector(`.list-films .fav[data-id="${e.imdbID}"]`),i=document.querySelector(`.favorites .fav[data-id="${e.imdbID}"]`),n=document.querySelector(".display-2 .fav");for(let o of t)if(o.imdbID==e.imdbID)return p(0,e.imdbID),null!==r&&r.classList.remove("fav-click"),null!==n&&n.classList.remove("fav-click"),void i.classList.remove("fav-click");t.push(e);try{localStorage.setItem("films",JSON.stringify(t)),null!==r&&r.classList.add("fav-click"),n.classList.add("fav-click"),(new h).renderFilmsToFavorites()}catch(e){alert("Память заполнена.")}},v="http://www.omdbapi.com/";class S{static async getFilms(e){try{const t=await fetch(`${v}/${e}&apikey=d5677312`),r=await t.json();return r.Search||r}catch(e){console.log(e)}}}class h{constructor(e){this.options=e,this.favorite=!1,this.favorites=document.querySelector(".favorites"),this.removeFromStorage=p,this.storageData=JSON.parse(localStorage.getItem("films")||"[]")}openFilm(e,t){e.preventDefault(),S.getFilms(`?i=${t}`).then(e=>{f(e),document.querySelector(".display-1").style.display="none",document.querySelector(".display-2").style.display="block"})}renderFilmsToFavorites(){const e=JSON.parse(localStorage.getItem("films")||"[]");this.favorites.innerHTML="";for(let t of e){const e=this.render(t,this.removeFromStorage);this.favorites.appendChild(e)}}insertToStorage(e,t){const r=JSON.parse(localStorage.getItem("films")||"[]"),i=document.querySelector(`.favorites .fav[data-id="${t}"]`),n=document.querySelector(`.list-films .fav[data-id="${t}"]`);for(let e of r)if(e.imdbID==t)return this.removeFromStorage(null,t),i.classList.remove("fav-click"),void n.classList.remove("fav-click");r.push(this.options);try{localStorage.setItem("films",JSON.stringify(r)),n.classList.add("fav-click"),this.renderFilmsToFavorites()}catch(e){alert("Память заполнена.")}}render(e,t){const{Poster:r,imdbID:i,Title:n,Year:o}=e||this.options,s=document.createElement("div"),a=document.createElement("img"),l=document.createElement("p"),c=document.createElement("a"),d=document.createElement("button");return this.storageData.map(e=>{e.imdbID==i&&d.classList.add("fav-click")}),d.dataset.id=i,d.innerHTML="♥",d.classList.add("fav"),void 0!==t&&d.classList.add("fav-click"),d.addEventListener("click",e=>{void 0!==t?t(e,i):this.insertToStorage(e,i)}),c.href="#",c.innerHTML="Узнать больше",c.addEventListener("click",e=>this.openFilm(e,i)),a.alt="",a.src="N/A"!==r?r:"./img/notfound.png",l.innerHTML=`${n}(${o})`,s.classList.add("list-item"),s.dataset.idFilm=i,s.appendChild(a),s.appendChild(c),s.appendChild(d),s.appendChild(l),s}}const g=new class{embeded(e){S.getFilms(e).then(e=>{if("False"===e.Response)throw"Ничего не найдено";n.innerHTML="",u(e)}).catch(e=>{i.innerHTML="",n.innerHTML=e})}searchFilms(){document.querySelector("form").onsubmit=(e=>{e.preventDefault();const t=document.querySelector('[type="search"]').value.trim();if(t.toLowerCase(),t){let e=t.split(" ");if(e.length>1){let t=e.join("+");this.embeded(`?s=${t}`)}else this.embeded(`?s=${t}`)}else console.log("Не введено значение")})}render(){return'\n    <form>\n        <input type="search">\n        <input type="submit" value="Начать поиск">\n    </form>\n    '}};g.render(),g.searchFilms(),(new h).renderFilmsToFavorites()}]);